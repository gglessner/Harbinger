# Harbinger Configuration File
# Author: Garland Glessner <gglessner@gmail.com>
# License: GNU GPL

# Email Configuration
# Option 1: SMTP Configuration (commented out)
# email:
#   smtp_server: "smtp.gmail.com"
#   smtp_port: 587
#   use_tls: true
#   username: "test@example.com"
#   password: "test-password"
#   from_address: "test@example.com"

# Option 2: Local Mail Configuration (using mail -s command)
email:
  use_local_mail: true
  mail_command: "mail"  # or "/usr/bin/mail" for full path
  from_address: "noreply@domain.com"  # Optional: sender address for mail -r flag

# Logging Configuration
logging:
  level: "INFO"  # DEBUG, INFO, WARNING, ERROR
  file: "harbinger.log"

# Report Configuration
reports:
  save_to_file: true  # Set to true to save reports to timestamped files
  directory: "reports"  # Directory to save report files (will be created if it doesn't exist)

# Standalone Mode Configuration
standalone:
  report_time: "08:00"  # Daily report time (24-hour format)

# Port Monitoring Sections
# Each port_* section defines monitoring for a specific TCP port

# Example 1: Basic port scanning with service detection
port_ssh:
  port: 22
  label: "Network Security"
  port_label: "SSH"
  email: "security@company.com"
  nmap_scan: "nmap -p {port} --open 10.0.0.0/24"
  post_command: "python post_command/port_check.py {host} {port} && nmap -sV -p {port} {host}"

# Example 2: HTTP service with TLS detection
port_web:
  port: 80
  label: "Network Security"
  port_label: "HTTP"
  email: "security@company.com"
  command: "nmap -p {port} --open 10.0.0.0/24"
  post_command: "python post_command/port_check.py {host} {port} && (python post_command/tls_check.py {host} {port} && curl -k -I https://{host} || curl -I http://{host})"

# Example 3: HTTPS with TLS verification and certificate collection
port_https:
  port: 443
  label: "Network Security"
  port_label: "HTTPS"
  email: "security@company.com"
  nmap_scan: "nmap -p {port} --open --max-retries 2 10.0.0.0/24"
  post_command: "python post_command/port_check.py {host} {port} && python post_command/tls_check.py {host} {port} && python post_command/cert_collector.py {host} {port} && curl -I https://{host}"

# Example 4: RDP with service detection
port_rdp:
  port: 3389
  label: "Admin Services"
  port_label: "RDP"
  email: "admin@company.com"
  command: "nmap -p {port} --open 10.0.0.0/24"
  post_command: "python post_command/port_check.py {host} {port} && nmap -sV -p {port} {host}"

# Example 5: Optimized Kafka security scanner with TLS detection and certificate collection
port_kafka:
  port: 9092
  label: "Data Services"
  port_label: "Kafka"
  email: "security@company.com"
  nmap_scan: "nmap -p {port} --open 10.0.0.0/24"
  post_command: "python post_command/port_check.py {host} {port} && (python post_command/tls_check.py {host} {port} && python post_command/cert_collector.py {host} {port} && python post_command/kafka.py --tls {host} {port} || python post_command/kafka.py {host} {port})"

# Example 6: Kafka TLS port with TLS-only testing and certificate collection
port_kafka_tls:
  port: 9093
  label: "Data Services"
  port_label: "Kafka TLS"
  email: "security@company.com"
  nmap_scan: "nmap -p {port} --open 10.0.0.0/24"
  post_command: "python post_command/port_check.py {host} {port} && python post_command/tls_check.py {host} {port} && python post_command/cert_collector.py {host} {port} && python post_command/kafka.py --tls {host} {port} || echo 'TLS not available'"

# Example 6.5: STOMP messaging with TLS detection and certificate collection
port_stomp:
  port: 61613
  label: "Data Services"
  port_label: "STOMP"
  email: "security@company.com"
  nmap_scan: "nmap -p {port} --open 10.0.0.0/24"
  post_command: "python post_command/port_check.py {host} {port} && (python post_command/tls_check.py {host} {port} && python post_command/cert_collector.py {host} {port} && python post_command/stomp.py --tls {host} {port} || python post_command/stomp.py {host} {port})"

# Example 6.6: RabbitMQ Management Web API with TLS detection and certificate collection
port_rabbitmq:
  port: 15672
  label: "Data Services"
  port_label: "RabbitMQ Management"
  email: "security@company.com"
  nmap_scan: "nmap -p {port} --open 10.0.0.0/24"
  post_command: "python post_command/port_check.py {host} {port} && (python post_command/tls_check.py {host} {port} && python post_command/cert_collector.py {host} {port} && python post_command/rabbitmq-web.py --tls {host} {port} || python post_command/rabbitmq-web.py {host} {port})"

# Example 6.7: Apache ActiveMQ Web Console with TLS detection and certificate collection
port_activemq:
  port: 8161
  label: "Data Services"
  port_label: "ActiveMQ Web Console"
  email: "security@company.com"
  nmap_scan: "nmap -p {port} --open 10.0.0.0/24"
  post_command: "python post_command/port_check.py {host} {port} && (python post_command/tls_check.py {host} {port} && python post_command/cert_collector.py {host} {port} && python post_command/activemq-web.py --tls {host} {port} || python post_command/activemq-web.py {host} {port})"

# Example 7: HTTP service with full response capture
port_http_full:
  port: 80
  label: "Web Services"
  port_label: "HTTP Full"
  email: "security@company.com"
  nmap_scan: "nmap -p {port} --open 10.0.0.0/24"
  post_command: "python post_command/port_check.py {host} {port} && python post_command/http_check.py {host} {port}"

# Example 7: HTTPS service with full response capture and certificate collection
port_https_full:
  port: 443
  label: "Web Services"
  port_label: "HTTPS Full"
  email: "security@company.com"
  nmap_scan: "nmap -p {port} --open 10.0.0.0/24"
  post_command: "python post_command/port_check.py {host} {port} && python post_command/tls_check.py {host} {port} && python post_command/cert_collector.py {host} {port} && python post_command/http_check.py {host} {port} https"

# Example 8: Custom web application path testing
port_webapp:
  port: 8080
  label: "Development"
  port_label: "Web App"
  email: "devops@company.com"
  nmap_scan: "nmap -p {port} --open 10.0.0.0/24"
  post_command: "python post_command/port_check.py {host} {port} && python post_command/http_check.py {host} {port} http /api/status"

# Example 9: Custom script (works on both Windows and Linux)
port_custom:
  port: 9000
  label: "Development"
  port_label: "Custom Service"
  email: "devops@company.com"
  command: "python custom_scanner.py --subnet 10.0.0.0/24 --port {port}"

# Example 10: TLS certificate collection for truststore (certificates only)
port_https_cert:
  port: 443
  label: "Certificate Collection"
  port_label: "HTTPS Cert"
  email: "security@company.com"
  nmap_scan: "nmap -p {port} --open 10.0.0.0/24"
  post_command: "python post_command/port_check.py {host} {port} && python post_command/tls_check.py {host} {port} && python post_command/cert_collector.py {host} {port}"

# Example 11: Web service using collected certificates
port_https_secure:
  port: 443
  label: "Web Services"
  port_label: "HTTPS Secure"
  email: "security@company.com"
  nmap_scan: "nmap -p {port} --open 10.0.0.0/24"
  post_command: "python post_command/port_check.py {host} {port} && python post_command/http_check.py {host} {port} --tls --url /api/status"

# Example 12: Report-only monitoring (no email sent)
port_dns:
  port: 53
  label: "Internal Monitoring"
  port_label: "DNS"
  # No email field = report-only mode
  nmap_scan: "nmap -p {port} --open 10.0.0.0/24"
  post_command: "nslookup {host}"

# Example 13: Apache ZooKeeper security scanning
port_zookeeper:
  port: 2181
  label: "Data Services"
  port_label: "ZooKeeper"
  email: "security@company.com"
  nmap_scan: "nmap -p {port} --open 10.0.0.0/24"
  post_command: "post_command/zookeeper.sh {host} {port}"

# Example 14: Apache Cassandra security scanning
port_cassandra:
  port: 9042
  label: "Data Services"
  port_label: "Cassandra"
  email: "security@company.com"
  nmap_scan: "nmap -p {port} --open 10.0.0.0/24"
  post_command: "post_command/cassandra.sh {host} {port}"

# Example 15: Apache CouchDB security scanning
port_couchdb:
  port: 5984
  label: "Data Services"
  port_label: "CouchDB"
  email: "security@company.com"
  nmap_scan: "nmap -p {port} --open 10.0.0.0/24"
  post_command: "post_command/couchdb.sh {host} {port}"

# Example 16: Apache Derby security scanning
port_derby:
  port: 1527
  label: "Data Services"
  port_label: "Derby"
  email: "security@company.com"
  nmap_scan: "nmap -p {port} --open 10.0.0.0/24"
  post_command: "post_command/derby.sh {host} {port}"

# Example 17: Apache Hadoop NameNode Web UI security scanning
port_hadoop_namenode:
  port: 9870
  label: "Big Data Services"
  port_label: "Hadoop NameNode"
  email: "security@company.com"
  nmap_scan: "nmap -p {port} --open 10.0.0.0/24"
  post_command: "post_command/hadoop-namenode.sh {host} {port}"

# Example 18: Apache Flink JobManager Web UI security scanning
port_flink:
  port: 8081
  label: "Big Data Services"
  port_label: "Flink JobManager"
  email: "security@company.com"
  nmap_scan: "nmap -p {port} --open 10.0.0.0/24"
  post_command: "post_command/flink.sh {host} {port}"

# Example 19: Apache Ignite Discovery security scanning
port_ignite:
  port: 47500
  label: "Data Services"
  port_label: "Ignite Discovery"
  email: "security@company.com"
  nmap_scan: "nmap -p {port} --open 10.0.0.0/24"
  post_command: "post_command/ignite.sh {host} {port}"

# Example 20: Apache Ignite Thin Client security scanning
port_ignite_thin:
  port: 10800
  label: "Data Services"
  port_label: "Ignite Thin Client"
  email: "security@company.com"
  nmap_scan: "nmap -p {port} --open 10.0.0.0/24"
  post_command: "post_command/ignite-thin.sh {host} {port}"

# Example 21: Apache Flume security scanning
port_flume:
  port: 41414
  label: "Data Services"
  port_label: "Flume"
  email: "security@company.com"
  nmap_scan: "nmap -p {port} --open 10.0.0.0/24"
  post_command: "post_command/flume.sh {host} {port}"

# Example 22: Apache Karaf SSH Console security scanning
port_karaf_ssh:
  port: 8101
  label: "Application Servers"
  port_label: "Karaf SSH"
  email: "security@company.com"
  nmap_scan: "nmap -p {port} --open 10.0.0.0/24"
  post_command: "post_command/karaf-ssh.sh {host} {port}"

# Example 23: Apache Karaf Web Console security scanning
port_karaf_web:
  port: 8181
  label: "Application Servers"
  port_label: "Karaf Web Console"
  email: "security@company.com"
  nmap_scan: "nmap -p {port} --open 10.0.0.0/24"
  post_command: "post_command/karaf-web.sh {host} {port}"

# Example 24: Apache JMeter HTTP Test Script Recorder security scanning
port_jmeter:
  port: 8888
  label: "Testing Tools"
  port_label: "JMeter HTTP Test Script Recorder"
  email: "security@company.com"
  nmap_scan: "nmap -p {port} --open 10.0.0.0/24"
  post_command: "post_command/jmeter.sh {host} {port}"

# Example 25: Memcached security scanning
port_memcached:
  port: 11211
  label: "Caching Services"
  port_label: "Memcached"
  email: "security@company.com"
  nmap_scan: "nmap -p {port} --open 10.0.0.0/24"
  post_command: "post_command/memcached.sh {host} {port}"

# Example 26: MongoDB security scanning
port_mongodb:
  port: 27017
  label: "Database Services"
  port_label: "MongoDB"
  email: "security@company.com"
  nmap_scan: "nmap -p {port} --open 10.0.0.0/24"
  post_command: "post_command/mongodb.sh {host} {port}"

# Example 27: InfluxDB security scanning
port_influxdb:
  port: 8086
  label: "Time Series Databases"
  port_label: "InfluxDB"
  email: "security@company.com"
  nmap_scan: "nmap -p {port} --open 10.0.0.0/24"
  post_command: "post_command/influxdb.sh {host} {port}"

# Example 28: Etcd security scanning
port_etcd:
  port: 2379
  label: "Distributed Systems"
  port_label: "Etcd"
  email: "security@company.com"
  nmap_scan: "nmap -p {port} --open 10.0.0.0/24"
  post_command: "post_command/etcd.sh {host} {port}"

# Example 29: Hazelcast security scanning
port_hazelcast:
  port: 5701
  label: "In-Memory Data Grids"
  port_label: "Hazelcast"
  email: "security@company.com"
  nmap_scan: "nmap -p {port} --open 10.0.0.0/24"
  post_command: "post_command/hazelcast.sh {host} {port}"

# Example 30: JBoss WildFly Management Console security scanning
port_wildfly:
  port: 9990
  label: "Application Servers"
  port_label: "WildFly Management"
  email: "security@company.com"
  nmap_scan: "nmap -p {port} --open 10.0.0.0/24"
  post_command: "post_command/wildfly.sh {host} {port}"

# Example 31: Oracle WebLogic Administration Console security scanning
port_weblogic:
  port: 7001
  label: "Application Servers"
  port_label: "WebLogic Admin Console"
  email: "security@company.com"
  nmap_scan: "nmap -p {port} --open 10.0.0.0/24"
  post_command: "post_command/weblogic.sh {host} {port}"

# Example 32: IBM WebSphere Administration Console security scanning
port_websphere:
  port: 9060
  label: "Application Servers"
  port_label: "WebSphere Admin Console"
  email: "security@company.com"
  nmap_scan: "nmap -p {port} --open 10.0.0.0/24"
  post_command: "post_command/websphere.sh {host} {port}"

# Example 33: PostgreSQL security scanning
port_postgresql:
  port: 5432
  label: "Database Services"
  port_label: "PostgreSQL"
  email: "security@company.com"
  nmap_scan: "nmap -p {port} --open 10.0.0.0/24"
  post_command: "post_command/postgresql.sh {host} {port}"

# Example 34: Microsoft SQL Server security scanning
port_mssql:
  port: 1433
  label: "Database Services"
  port_label: "Microsoft SQL Server"
  email: "security@company.com"
  nmap_scan: "nmap -p {port} --open 10.0.0.0/24"
  post_command: "post_command/mssql.sh {host} {port}"

# Example 35: NATS security scanning
port_nats:
  port: 4222
  label: "Messaging Services"
  port_label: "NATS"
  email: "security@company.com"
  nmap_scan: "nmap -p {port} --open 10.0.0.0/24"
  post_command: "post_command/nats.sh {host} {port}"

# Example 36: Mosquitto MQTT security scanning
port_mosquitto:
  port: 1883
  label: "Messaging Services"
  port_label: "Mosquitto MQTT"
  email: "security@company.com"
  nmap_scan: "nmap -p {port} --open 10.0.0.0/24"
  post_command: "post_command/mosquitto.sh {host} {port}"

# Example 37: Docker API security scanning
port_docker_api:
  port: 2375
  label: "Container Services"
  port_label: "Docker API"
  email: "security@company.com"
  nmap_scan: "nmap -p {port} --open 10.0.0.0/24"
  post_command: "post_command/docker-api.sh {host} {port}"

# Example 38: MySQL security scanning
port_mysql:
  port: 3306
  label: "Database Services"
  port_label: "MySQL"
  email: "security@company.com"
  nmap_scan: "nmap -p {port} --open 10.0.0.0/24"
  post_command: "post_command/mysql.sh {host} {port}"

# Example 39: Neo4j security scanning
port_neo4j:
  port: 7474
  label: "Database Services"
  port_label: "Neo4j"
  email: "security@company.com"
  nmap_scan: "nmap -p {port} --open 10.0.0.0/24"
  post_command: "post_command/neo4j.sh {host} {port}"

# Example 40: ClickHouse security scanning
port_clickhouse:
  port: 8123
  label: "Database Services"
  port_label: "ClickHouse"
  email: "security@company.com"
  nmap_scan: "nmap -p {port} --open 10.0.0.0/24"
  post_command: "post_command/clickhouse.sh {host} {port}"

# Example 41: LDAP security scanning
port_ldap:
  port: 389
  label: "Directory Services"
  port_label: "LDAP"
  email: "security@company.com"
  nmap_scan: "nmap -p {port} --open 10.0.0.0/24"
  post_command: "post_command/ldap.sh {host} {port}"

# Example 42: TeamCity security scanning
port_teamcity:
  port: 8111
  label: "CI/CD Services"
  port_label: "TeamCity"
  email: "security@company.com"
  nmap_scan: "nmap -p {port} --open 10.0.0.0/24"
  post_command: "post_command/teamcity.sh {host} {port}"

# Example 43: Graylog security scanning
port_graylog:
  port: 9000
  label: "Logging Services"
  port_label: "Graylog"
  email: "security@company.com"
  nmap_scan: "nmap -p {port} --open 10.0.0.0/24"
  post_command: "post_command/graylog.sh {host} {port}"

# Example 44: Confluence security scanning
port_confluence:
  port: 8090
  label: "Collaboration Services"
  port_label: "Confluence"
  email: "security@company.com"
  nmap_scan: "nmap -p {port} --open 10.0.0.0/24"
  post_command: "post_command/confluence.sh {host} {port}"